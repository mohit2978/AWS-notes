# AWS infrastructure
The services and resources provided by AWS are housed in data centers. These data centers are spread out strategically to optimize availability and decrease network latency. The locations are categorized among regions and availability zones. The diagram given below illustrates the divison among regions and availability zones.

![alt text](image.png)

### Regions
In an AWS cloud, AWS Regions are the largest unit. They are separate geographic locations. Each region consists of clusters of data centers called Availability Zones. Currently, AWS supports seven regions, including Asia, North America, South America, and more. 

### Availability Zones
As discussed above, regions consist of availability zones. Availability Zones are essentially data centers to host AWS resources. Each region consists of at least three availability zones. These zones increase the fault tolerance of the region. All of the Availability Zones within a region are connected to each other via dedicated channels with high bandwidth

### Create an IAM User

Identity Access and Management (IAM) users are entities created within an AWS account to represent individual users who need access to AWS services and resources. IAM users have associated security credentials, such as access keys and passwords, which allow AWS to authenticate the users. IAM users also have a policy attached (directly or indirectly) that specifies the authorization rights of the user called identity-based policies. Identity-based Policies specify the actions and services a user is allowed. eg

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PolicyToGetS3Objects",
            "Effect": "Allow",
            "Action": "s3:GetObject",
            "Resource": "*",
            
        }
    ]
}
```

Let’s briefly discuss some important fields of the policy shown above:

- Version: It helps AWS understand the version of the syntax used in the policy.

- Statement: It contains the main element of the policy. A statement can have a single or multiple blocks.

- Effect: It specifies whether the statement allows or denies access.. It can have two values: “Allow” or “Deny.”

- Action: It defines the AWS actions that the policy is granting or denying permission for. In this case, the statement is allowing GetObject action of the S3 service.

- Resource: It specifies the AWS resources to which the statement’s permissions apply. Resources are identified using Amazon Resource Names (ARN). In the policy given above, the symbol * specifies that the policy applies to all resources.

The policy given above allows the user to get objects from an S3 bucket. 
### user creation
Let’s create an IAM user by following the given steps:

- Search “IAM” in the search bar on top of the AWS Management Console. Click “Users” under “Access management” from the left sidebar. This takes us to a list of all available users in our account.

- Click the “Create user” button to create a new user.

- Name the user IAMLabUser.

- Check the “Provide user access to the AWS Management Console - optional” option.

- For “Console password,” we can either select the “Autogenerated password” option or the “Custom password” option and set a password of our choice. We’ll select the “Autogenerated password” option.

- Uncheck the “Users must create a new password at next sign-in (recommended).” option and click the “Next” button.

- On the “Set permissions” page, select the “Attach policies directly” option from the “Permissions options” section.

![alt text](image-1.png)
- Search for the IAMLabPolicy using the search bar in the “Permissions policies”.

- Select IAMLabPolicy and click the “Next” button.

![alt text](image-2.png)

- On the “Review and create” page, click the “Create user” button.

- We’ll now see the “Console sign-in details.” Copy the “Console sign-in URL,” “User name,” and “Console password,” and keep them safe or download the credentials by clicking the “Download .csv file” button.

- Click the “Return to users list” button.

![alt text](image-3.png)

### Login using the new user
We’ve now created a new user IAMLabUser which has the IAMLabPolicy policy attached to it. Now, let’s log in as the new user we’ve just created. Follow the given steps to proceed:

- Open a new private window to log in as IAMLabUser without logging out from your current AWS session.

- Navigate to the “Console sign-in URL” you copied in the previous step. This will take you to the AWS Management Console sign-in page with the account ID already entered.

- Enter IAMLabUser for “IAM user name.”

- Enter the “Console password” you copied in the last step for “Password.”

- Click the “Sign in” button to log in to the AWS Management Console.

### Create an S3 Bucket

AWS Simple Storage Service (S3) is one of the storage services provided by AWS. S3 is commonly used to store data, including images, web application content, backups, logs, and more. Each S3 bucket has a globally unique name and is inaccessible to the public by default.

In this lab, we will create a bucket to store the contents of the web page. After the completion of this task, the provisioned infrastructure would be similar to the one shown in the figure below:

### Steps

- Open the AWS Management Console for “IAMLabUser.” Search “S3” on the AWS Management Console and click “S3” from the search results. This takes us to the S3 dashboard.

- Click the “Create bucket” button.

![alt text](image-4.png)
- In the general configuration tab, make sure that the “AWS Region” is set to “US East (N. Virginia) us-east-1”. If not, switch to the “N.Virgina” region using the drop-down menu on the top-right of the screen next to the user name.

- Enter a name for the bucket. For this lab, web-content-bucket should be the first letters of the bucket’s name. Append allowed characters with web-content-bucket to make the name globally unique.

- In the “Block Public Access settings for this bucket” section, uncheck the “Block all public access” option. We’ll define a policy to restrict access in the next task.

- Acknowledge the public access warning by checking it.

- Scroll down to the end of the page and click the “Create bucket” button. We’ll now be redirected to the S3 Buckets page

![alt text](image-5.png)

### Upload files to S3 Bucket

In this task, we’ll upload an image and index.html file to our S3 bucket. The infrastructure at the end of the task would look similar to the one given below:

#### steps
1. Search “S3” in the search bar to open the S3 dashboard. Click “Buckets” on the side bar to list the buckets.

2. Click the bucket name we’ve just created. We’ll be redirected to the bucket page.

3. On the “Objects” tab, click the “Upload” button. We’ll be redirected to the upload page.

![alt text](image-6.png)

4. Click the “Add files” button in the “Files and folders” section.

5. Upload any image you want to display on your web page. You can also download the Educative’s logo. Click the “Upload” button. Close the success prompt to be redirected to the “Objects” tab, which lists the name of the uploaded image.

![alt text](image-7.png)

6. Here, click the name of your image. Copy the “Object URL” and save it.

![alt text](image-8.png)
---
![alt text](image-9.png)
7. Next, download the HTML file and paste the Object URL into the HTML file.

![](image-10.png)

pasted in line 23

8. Upload this HTML file on the “Objects” tab.

With that, we’ve successfully uploaded a file and an image to our S3 bucket. However, this file isn’t publicly accessible at this point. Let’s verify this by accessing the file using the public URL.

- Select the index.html file we just uploaded from the “Objects” section and copy the URL listed below "Object URL." This is the publicly accessible URL for the file.

- Open a new browser tab and paste the URL in the search bar. We’ll see an access denied error. This is because the bucket contents are not publicly accessible at this point. In the previous task, we had allowed public access. However, we’ll have to add a bucket policy to manage access.

![alt text](image-11.png)

## Add a resource-based policy to the bucket
We can manage the access to our S3 bucket using resource-based policies. Their structure is similar to IAM policies discussed in the previous task except for the “Principal” element, which defines the IAM identity that can perform the action.

### steps

- Go back to the “Buckets” tab and click on your bucket’s name. Click the “Permissions” tab on the bucket page.

- Scroll down and click the “Edit” button in the “Bucket policy” section.

- Copy the policy from the code widget below and paste it into the policy editor window.

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "BucketAccess",
            "Action": "s3:GetObject",
            "Effect": "Allow",
            "Resource": "<ARN>/*",
            "Principal": "*"
        }
    ]
}
```
- Replace  [ARN ] in line 8 with the Amazon Resource Name (ARN) of our bucket. You can find the ARN in properties or just above editor.

![alt text](image-12.png)

---
![alt text](image-13.png)

- Click the “Save changes” button.

### output:

![alt text](image-14.png)

# Create Security Group

Amazon Elastic Cloud Compute (EC2) provides scalable computing services. Using EC2, we can deploy EC2 instances, which are essentially customizable (virtual) machines deployed to acquire on-demand, secure, and scalable hardware. There are several types of EC2 instances used for specific user requirements.

EC2 also provides support for multiple operating systems through Amazon machine images. Amazon Machine Images (AMI) store the basic components required for an operating system. AWS provides AMI options for Linux, Windows, Mac, etc. However, you can use your own AMI.

Security and access to an EC2 instance can be managed using security groups and key pairs. Security groups are rules that manage the inbound and outbound traffic for the instance. In simple terms, they can be considered a firewall for the instance. Similarly, key pairs consist of a private key stored on the local computer and a public key stored on the EC2 instance, which allows one to connect to an instance.

Furthermore, we can allow our EC2 instances to access other services using IAM roles. AWS Identity Access and Management (IAM) roles are AWS identities with an identity-based policy specifying their access. So far, this is similar to IAM users. However, what makes roles unique is that instead of being directly associated with someone, anyone can assume a role, including IAM users and AWS services. This gives them temporary credentials to access resources and services based on the policy.

In this task, we’ll create a security group to allow SSH and HTTP connections to the instance. Also, we’ll create an IAM role for the EC2 instance to allow it to access objects of the S3 bucket. The provisioned infrastructure would look similar to the one given below:

![alt text](image-15.png)

### Create a security group

- On the AWS Management Console, search for “EC2” and click the EC2 service from the search results. This takes us to the EC2 dashboard.

- In the sidebar,in network and security, click the “Security Groups” option under the “Network & Security” section.

- Click the “Create security group” button.

#### Follow these steps to configure the security group:

- Basic details

    - Enter web-app-security-group as the security group name.

    - Enter Security group for EC2 instance as the description.

    - Keep the default VPC under the “VPC” option.

- Inbound rules

    - Add the first inbound rule as follows:

        - Click the “Add rule” button under “Inbound rules.”

        - Select SSH as the type.

        - Enter Anywhere-IPv4 as the source.

    - Add the second inbound rule as follows:

        - Click the “Add rule” button under “Inbound rules.”

        - Select HTTP as the type.

        - Enter Anywhere-IPv4 as the source.

- Outbound rules

    - Keep the existing default rule, as we do not need to change or add outbound rules.

Once you finish the steps above, click the “Create security group” button.

We have successfully created a security group.

![alt text](image-16.png)

## Create an IAM role
We need an IAM role to allow our EC2 instance to access the bucket. For the role, we’ll use S3AccessPolicy. The policy is already created and defines basic permission to get the contents of an S3 bucket. Hence, if the EC2 instance assumes this role, it can access the bucket’s contents.

Follow the steps below to create an IAM role:

- On the AWS Management Console, search for “IAM” and select “IAM” from the search results. This takes us to the IAM dashboard.

- Click “Roles” under the “Access management” heading in the left menu bar.

- Click the “Create role” button.

    - For “Trusted entity type,” select “AWS service.”

    - Click the drop-down menu for “Use case” and select “EC2”.

    - Click the “Next” button.

- On the “Add permissions” page, search for S3AccessPolicy under the “Permissions policies” section.

- Select the S3AccessPolicy policy from the search results and click the “Next” button.

- Name the role AccessBucketRole.

- Scroll to the end of the page and click the “Create role” button.